---
// src/pages/index.astro
import { getCollection } from 'astro:content';

// 获取所有 reports 文件夹里的报告，并按日期降序排列
const allReports = await getCollection('reports', ({ data }) => {
    return data; // 可以添加过滤逻辑
});
const sortedReports = allReports.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>情报报告存档</title>
    <link rel="stylesheet" href="/assets/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>情报报告存档</h1>
            <p>由 n8n-driven-content-hub 自动生成</p>
        </header>
        <main>
            <ul class="report-list">
                {sortedReports.map(report => (
                    <li>
                        <a href={`/reports/${report.slug}/`}>
                            <span class="date">{report.data.date.toLocaleDateString()}</span>
                            <span class="title">{report.data.title}</span>
                        </a>
                    </li>
                ))}
            </ul>
        </main>
    </div>
</body>
</html>